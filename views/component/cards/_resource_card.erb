
<div class="card resource-card" style="width: 18rem;" id="<%= resource.id %>">
  <div class="image-container">
    <%= erb :'component/modals/_share_modal_button', locals: {
      facebook: resource.fb_share,
      twitter: resource.tw_share,
      linkedin: resource.li_share,
      resource_link: resource.kleer_share_url
    }%>
    <%= erb :'component/_image', locals: {image_url: resource.cover, css_class: 'card-img-top', alt: '...', has_webp: false}%>
  </div>
  <div class="card-body body clearfix">
    <h2 class="card-title title"><%= resource.title %></h2>
    <p class="card-text subtitle"><%= resource.description%></p>
    <ul class="items">
      <% unless resource.authors_list == [] %>
        <li>
          <%= erb :'component/cards/_authors_block', locals: {authors: resource.authors_list, title: 'Autores'} %>
        </li>
      <% end %>
      <% unless resource.translators_list == [] %>
        <li>
          <%= erb :'component/cards/_authors_block', locals: {authors: resource.translators_list, title: 'Traductores'} %>
        </li>
      <% end %>
      <% unless resource.comments == '' %>
        <li style="padding-left: 8px">
          <b>Observaciones: </b> <%= resource.comments %>
        </li>
      <% end %>
    </ul>

  </div>
  <div class="footer">
    <% unless resource.buyit  == '' %>
      <p>
        <a class="external-web">Compra en web externa</a>
      </p>
    <% end %>

    <% unless resource.landing == '' %>
      <p>
        <a href="<%= resource.landing %>" class="info my-secondary-button">Mas info</a>
      </p>
    <% end %>
    <% unless resource.buyit == '' %>
      <a href="<%= resource.buyit %>" class="my-primary-button button">
        Obtener
        <img src='/app/img/icons/ExternalLink.svg'/>
      </a>
    <% end %>
    <% unless resource.getit == '' %>
      <a href="<%= resource.getit %>" class="my-primary-button button">
        Descargar
        <img src='/app/img/icons/Download.svg'/>
      </a>
    <% end %>
  </div>
</div>

<script>
  {
      let actualCard = document.getElementById('<%= resource.id %>')
      let body = actualCard.querySelector('.body')
      let quantityButtons = actualCard.querySelector('.footer').children.length
      let height = body.offsetHeight

      const collapseBody = (limit) => {
          let bodyString = body.children[1].innerHTML
          body.children[1].innerHTML = bodyString.substring(0, limit) + '...'
      }

      if (height > 350 && height < 380 && quantityButtons === 1){
          collapseBody(150)
      }else if (height > 280 && quantityButtons > 1) {
          console.log(`height: ${height} quantityButtons: ${quantityButtons} name <%= resource.id %>`)
          collapseBody(100)
      }else if (height > 380 && height < 500){
          collapseBody(100)
      }

  }

</script>
